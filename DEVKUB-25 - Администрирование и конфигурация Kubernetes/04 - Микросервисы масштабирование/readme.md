# Домашнее задание к занятию «Микросервисы: масштабирование»

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развёртывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- поддержка контейнеров;
- обеспечивать обнаружение сервисов и маршрутизацию запросов;
- обеспечивать возможность горизонтального масштабирования;
- обеспечивать возможность автоматического масштабирования;
- обеспечивать явное разделение ресурсов, доступных извне и внутри системы;
- обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т. п.

Обоснуйте свой выбор.

### Ответ на задачу 1

Инструментов стало дольно много... но с вершины моего неглубокого опыта можно выделить следующие варианты:

* **GitLab CI/CD** - Один из самых распространненых CI/CD-инструментов. Здесь сразу предлагают различные функции: просмотр и хранение кода кода, CI/CD, непрерывное развертывание и многое другое буквально из коробкии. Для использования собственных докер образов можно использовать docker hub или artifactory, но можно не гнушаться и использованием gitlab registry.

* **ArgoCD** — один из самых популярных GitOps-инструментов. Он живет внутри Kubernetes и там же развертывает сущности. Argo CD предоставляет удобный RBAC, то есть управление правами и доступами. В интерфейсе можно посмотреть свои действия, управлять приложениями и  принудительно синхронизировать их. Argo CD входит в CNCF, что вызывает к нему большое доверие. 

* **werf** - Werf - это утилита, объединяющая CI/CD системы (типа GitLab, GitHub Actions), docker и helm в одном флаконе и позволяющая одной командой собрать образ контейнера, запушить его в репозиторий контейнеров и задеплоить с помощью helm. Весьма интересная штука, как по мне.

* **Jenkins** - Если у вас много ресурсов, то можно использовать бесплатный кроссплатформенный CI/CD-инструмент с открытым исходным кодом на базе Java. Он обеспечивает непрерывную интеграцию, а также непрерывную доставку. Для использования собственных докер образов можно использовать docker hub или artifactory.

* **TeamCity** -  Надежный и качественный CI-сервер. Команды часто выбирают TeamCity для большого количества функций аутентификации, развертывания и тестирования, а также поддержки docker. Обладает рядом уникальных функций, таких как подробные хронологические отчеты, мгновенные отзывы о неудачных тестах и повторное использование настроек, поэтому вам не нужно дублировать код.

* **Docker Swarm** - можно попробовать использовать, если... а) есть какой-то небольшой и нетребовательный сервис, который нужно максимально быстро развернуть; б) оркестратор нужен только для обучения и/или разработки локально; в) вы смотрите в будущее без интереса и не сильно расстроитесь, если поддержка продукта будет вялой.

* **OpenShift**  - если ваша компания из богатых и технологичных (привет, Селектел), у вас много ресурсов и времени, то добро пожаловать..

Если выбирать по совокупности факторов, то больше материалов и больше "все-в-одном" у Gitlab.
Но если есть возможность выбирать и нам, неожиданно, нужен популярный нынче кубернетес, то стоит внимательно присмотреться к werf и ArgoCD.

---

## Задача 2: Распределённый кеш * (необязательная)

Разработчикам вашей компании понадобился распределённый кеш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster, состоящий из трёх шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

---